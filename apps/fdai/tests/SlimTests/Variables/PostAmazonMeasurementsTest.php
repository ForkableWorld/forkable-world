<?php /** @noinspection PhpMissingReturnTypeInspection */
/** @noinspection PhpUnhandledExceptionInspection */
namespace Tests\SlimTests\Variables;
use App\Models\Measurement;
use App\Properties\Variable\VariableNameProperty;
use App\Slim\Model\Measurement\QMMeasurement;
use App\Slim\Model\Reminders\QMTrackingReminder;
use App\Storage\DB\TestDB;
use App\Units\CountUnit;
use App\Units\DollarsUnit;
use App\Units\OneToFiveRatingUnit;
use App\VariableCategories\TreatmentsVariableCategory;
use App\Variables\QMCommonVariable;
use App\Variables\QMUserVariable;
use Tests\UnitTests\Products\AmazonTest;
use Tests\DBUnitTestCase;

/**
 * Class PostMeasurementsTest
 * @package Tests\Api\Measurements
 */
class PostAmazonMeasurementsTest extends \Tests\SlimTests\SlimTestCase
{
    protected const DISABLED_UNTIL = AmazonTest::DISABLED_UNTIL;
    protected const REASON_FOR_SKIPPING =  AmazonTest::REASON_FOR_SKIPPING;
    /**
     * List of fixture files
     *
     * @var string[]
     */
    protected $fixtureFiles = [
        'user_variables' => 'empty/user_variables.xml',
        'variable_user_sources' => 'empty/variable_user_sources.xml',
    ];
    public function testPostAmazonMeasurements(){
        if($this->weShouldSkip()){return;}
        $this->truncateMeasurementsRemindersCorrelationsTables();
        $this->setAuthenticatedUser(1);
        //$this->assertObjectHasAttribute('name', $this->getUser(), \App\Logging\QMLog::print_r($this->getUser(), true));
        $responseData = $this->postAndCheckMeasurementsResponse($this->getAmazonPostData());
        $reminders = QMTrackingReminder::getTrackingReminders(1);
        $this->assertCount(1, $reminders);
        $commonVariable = QMCommonVariable::findByNameIdOrSynonym(VariableNameProperty::SPENDING_ON_VARIABLE_DISPLAY_NAME_PREFIX ."GE 71750 90-Watt 1260-Lumen Outdoor PAR38 Halogen Flood Light Bulb");
        $this->assertNotNull($commonVariable);
        $userVariable = QMUserVariable::findUserVariableByNameIdOrSynonym(1, VariableNameProperty::SPENDING_ON_VARIABLE_DISPLAY_NAME_PREFIX ."GE 71750 90-Watt 1260-Lumen Outdoor PAR38 Halogen Flood Light Bulb");
        $this->assertNotNull($userVariable);
        $responseData = $this->postAndCheckMeasurementsResponse($this->getAmazonPostData());
        /** @var QMUserVariable[] $userVariables */
        $userVariables = $responseData->userVariables;
        foreach ($userVariables as $userVariable){
            if($userVariable->unitAbbreviatedName === "$"){
                $this->assertNotEquals(0, $userVariable->lastValue);
            }
        }
        $toothPaste = QMCommonVariable::findByNameIdOrSynonym("Crest Cavity Protection Gel Toothpaste Cool Mint Gel, 6.4 oz., (Pack of 2)");
        $this->assertEquals(TreatmentsVariableCategory::NAME, $toothPaste->variableCategoryName);
        $this->assertVariablesContain(VariableNameProperty::SPENDING_ON_VARIABLE_DISPLAY_NAME_PREFIX ."Maldon Sea Salt Flakes", $userVariables);
        $this->assertVariablesContain(VariableNameProperty::SPENDING_ON_VARIABLE_DISPLAY_NAME_PREFIX ."Freshburst Listerine Antiseptic Mouthwash", $userVariables);
        $this->assertVariablesContain(VariableNameProperty::SPENDING_ON_VARIABLE_DISPLAY_NAME_PREFIX ."GE 71750 90-Watt 1260-Lumen Outdoor PAR38 Halogen Flood Light Bulb, 25-Degree Beam Spread, White - 2 Pack", $userVariables);
        $this->assertVariablesContain(VariableNameProperty::SPENDING_ON_VARIABLE_DISPLAY_NAME_PREFIX ."Sonic Electric Toothbrush Deep Clean as Dentist Sonicare", $userVariables);
        $this->assertDoesNotHaveTrackingReminderFor(VariableNameProperty::SPENDING_ON_VARIABLE_DISPLAY_NAME_PREFIX ."Maldon Sea Salt Flakes");
        $this->assertDoesNotHaveTrackingReminderFor("GE 71750 90-Watt 1260-Lumen Outdoor PAR38 Halogen Flood Light Bulb");
        $saltPayment = QMUserVariable::findUserVariableByNameIdOrSynonym(1, VariableNameProperty::SPENDING_ON_VARIABLE_DISPLAY_NAME_PREFIX ."Maldon Sea Salt Flakes");
        $this->assertEquals(DollarsUnit::NAME, $saltPayment->getUserOrCommonUnit()->name);
        $this->postAndCheckMeasurementsResponse($this->getAmazonPostData());
        $measurements = QMMeasurement::readonly()->where(Measurement::FIELD_SOURCE_NAME, "Amazon")->getArray();
        $this->assertTrue(count($measurements) > 3);
        foreach ($measurements as $measurement){
            $this->assertNotEquals(0, $measurement->value);
        }
        $reminders = QMTrackingReminder::getTrackingReminders($this->getOrSetAuthenticatedUser(1));
        $this->assertCount(1, $reminders);
    }
    public function testPostAmazonMeasurementAndCheckReminder(){
        if($this->weShouldSkip()){return;}
        $this->setAuthenticatedUser(1);
        $this->truncateMeasurementsRemindersCorrelationsTables();
        $variableName = "Nature Made Super B Complex Full Strength Softgels 60 Ct";
        $amazonMeasurements = '[{"id":"112-0686328-4181009", "date":"'.date('Y-m-d H:i:s').'","total":"$1.61","who":"Mike Sinn","detail_promise":{},
            "items":{"'.$variableName.'":"/gp/product/B071JY98QL/ref=oh_aui_detailpage_o02_s00?ie=UTF8&psc=1"},"request_scheduler":{"CONCURRENCY":6,"queue":{"content":[{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-0418470-3167402","priority":"111-0418470-3167402"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-5111836-1142626","priority":"111-5111836-1142626"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-1851209-8605861","priority":"111-1851209-8605861"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-6243057-9519402","priority":"111-6243057-9519402"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-5111836-1142626","priority":"111-5111836-1142626"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-6488000-5967432","priority":"111-6488000-5967432"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-1851209-8605861","priority":"111-1851209-8605861"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-3446725-9794664","priority":"113-3446725-9794664"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-6243057-9519402","priority":"111-6243057-9519402"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=112-0686328-4181009","priority":"112-0686328-4181009"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-6488000-5967432","priority":"111-6488000-5967432"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=114-3347246-4437821","priority":"114-3347246-4437821"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=113-2172109-7605841","priority":"113-2172109-7605841"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-2172109-7605841","priority":"113-2172109-7605841"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=113-3446725-9794664","priority":"113-3446725-9794664"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=114-3347246-4437821","priority":"114-3347246-4437821"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=114-6970661-1222608","priority":"114-6970661-1222608"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=114-6970661-1222608","priority":"114-6970661-1222608"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=112-0686328-4181009","priority":"112-0686328-4181009"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-9491172-9672222","priority":"113-9491172-9672222"}]},"running_count":6,"completed_count":2,"error_count":0},"payments_promise":{}}]';
        $start = microtime(true);
        $responseData = $this->postAndCheckMeasurementsResponse($amazonMeasurements);
        $firstRequestDuration = microtime(true) - $start;
        $start = microtime(true);
        $responseData = $this->postAndCheckMeasurementsResponse($amazonMeasurements);
        $secondRequestDuration = microtime(true) - $start;
        $this->assertLessThan($firstRequestDuration * 0.6, $secondRequestDuration);
        $reminders = QMTrackingReminder::getTrackingReminders($this->getOrSetAuthenticatedUser(1));
        $this->assertCount(1, $reminders);
        $this->assertNull($reminders[0]->defaultValue);
        $reminderName = $reminders[0]->variableName;
        if(stripos($reminderName, 'mini')){
            $this->assertEquals("Nature Made Super B Complex Full Strength Mini Softgels", $reminderName);
        } else {
            $this->assertStringStartsWith("Nature Made Super B Complex Full Strength Softgel", $reminderName);
        }
        $userVariable = QMUserVariable::findUserVariableByNameIdOrSynonym(1, $variableName);
        $this->assertEquals(CountUnit::NAME, $userVariable->getUserOrCommonUnit()->name);
        $this->assertNotNull($userVariable->productUrl);
        $this->assertEquals(TreatmentsVariableCategory::NAME, $userVariable->variableCategoryName);
    }
    /**
     * @return string
     */
    private function getAmazonPostData(){
        return '
            [{"id":"111-6598208-6933008","date":"'.date('Y-m-d H:i:s').'","total":"$10.41","who":"Mike Sinn","detail_promise":{},
            "items":{"GE 71750 90-Watt 1260-Lumen Outdoor PAR38 Halogen Flood Light Bulb, 25-Degree Beam Spread, White - 2 Pack":"/gp/product/B005GIRAH2/ref=oh_aui_detailpage_o00_s00?ie=UTF8&psc=1"},"request_scheduler":{"CONCURRENCY":6,"queue":{"content":[{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-0418470-3167402","priority":"111-0418470-3167402"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-5111836-1142626","priority":"111-5111836-1142626"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-1851209-8605861","priority":"111-1851209-8605861"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-6243057-9519402","priority":"111-6243057-9519402"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-5111836-1142626","priority":"111-5111836-1142626"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-6488000-5967432","priority":"111-6488000-5967432"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-1851209-8605861","priority":"111-1851209-8605861"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-3446725-9794664","priority":"113-3446725-9794664"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-6243057-9519402","priority":"111-6243057-9519402"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=112-0686328-4181009","priority":"112-0686328-4181009"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-6488000-5967432","priority":"111-6488000-5967432"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=114-3347246-4437821","priority":"114-3347246-4437821"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=113-2172109-7605841","priority":"113-2172109-7605841"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-2172109-7605841","priority":"113-2172109-7605841"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=113-3446725-9794664","priority":"113-3446725-9794664"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=114-3347246-4437821","priority":"114-3347246-4437821"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=114-6970661-1222608","priority":"114-6970661-1222608"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=114-6970661-1222608","priority":"114-6970661-1222608"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=112-0686328-4181009","priority":"112-0686328-4181009"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-9491172-9672222","priority":"113-9491172-9672222"}]},"running_count":6,"completed_count":2,"error_count":0},"payments_promise":{}},'.
            '{"id":"111-2891211-8649854","date":"February 23, 2017","total":"$5.83","who":"Mike Sinn","detail_promise":{},
            "items":{"Cooper Lighting 110 Degree Motion Detector Floodlight, Black":"/gp/product/B001EN7NF2/ref=oh_aui_detailpage_o01_s00?ie=UTF8&psc=1"},"request_scheduler":{"CONCURRENCY":6,"queue":{"content":[{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-0418470-3167402","priority":"111-0418470-3167402"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-5111836-1142626","priority":"111-5111836-1142626"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-1851209-8605861","priority":"111-1851209-8605861"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-6243057-9519402","priority":"111-6243057-9519402"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-5111836-1142626","priority":"111-5111836-1142626"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-6488000-5967432","priority":"111-6488000-5967432"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-1851209-8605861","priority":"111-1851209-8605861"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-3446725-9794664","priority":"113-3446725-9794664"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-6243057-9519402","priority":"111-6243057-9519402"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=112-0686328-4181009","priority":"112-0686328-4181009"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-6488000-5967432","priority":"111-6488000-5967432"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=114-3347246-4437821","priority":"114-3347246-4437821"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=113-2172109-7605841","priority":"113-2172109-7605841"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-2172109-7605841","priority":"113-2172109-7605841"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=113-3446725-9794664","priority":"113-3446725-9794664"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=114-3347246-4437821","priority":"114-3347246-4437821"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=114-6970661-1222608","priority":"114-6970661-1222608"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=114-6970661-1222608","priority":"114-6970661-1222608"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=112-0686328-4181009","priority":"112-0686328-4181009"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-9491172-9672222","priority":"113-9491172-9672222"}]},"running_count":6,"completed_count":2,"error_count":0},"payments_promise":{}},'.
            '{"id":"113-9491172-9672222","date":"February 23, 2017","total":"$6.69","who":"Mike Sinn","detail_promise":{},
            "items":{"Maldon Sea Salt Flakes, 8.5 ounce Box":"/gp/product/B00017028M/ref=oh_aui_detailpage_o02_s00?ie=UTF8&psc=1"},"request_scheduler":{"CONCURRENCY":6,"queue":{"content":[{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-0418470-3167402","priority":"111-0418470-3167402"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-5111836-1142626","priority":"111-5111836-1142626"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-1851209-8605861","priority":"111-1851209-8605861"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-6243057-9519402","priority":"111-6243057-9519402"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-5111836-1142626","priority":"111-5111836-1142626"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-6488000-5967432","priority":"111-6488000-5967432"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-1851209-8605861","priority":"111-1851209-8605861"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-3446725-9794664","priority":"113-3446725-9794664"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-6243057-9519402","priority":"111-6243057-9519402"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=112-0686328-4181009","priority":"112-0686328-4181009"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-6488000-5967432","priority":"111-6488000-5967432"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=114-3347246-4437821","priority":"114-3347246-4437821"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=113-2172109-7605841","priority":"113-2172109-7605841"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-2172109-7605841","priority":"113-2172109-7605841"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=113-3446725-9794664","priority":"113-3446725-9794664"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=114-3347246-4437821","priority":"114-3347246-4437821"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=114-6970661-1222608","priority":"114-6970661-1222608"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=114-6970661-1222608","priority":"114-6970661-1222608"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=112-0686328-4181009","priority":"112-0686328-4181009"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-9491172-9672222","priority":"113-9491172-9672222"}]},"running_count":6,"completed_count":2,"error_count":0},"payments_promise":{}},{"id":"114-3347246-4437821",
            "date":"'.date('Y-m-d H:i:s').'","total":"$9.83","who":"Mike Sinn","detail_promise":{},
            "items":{"Crest Cavity Protection Gel Toothpaste Cool Mint Gel, 6.4 oz., (Pack of 2)":"/gp/product/B00C6C05AA/ref=oh_aui_detailpage_o03_s00?ie=UTF8&psc=1"},"request_scheduler":{"CONCURRENCY":6,"queue":{"content":[{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-0418470-3167402","priority":"111-0418470-3167402"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-5111836-1142626","priority":"111-5111836-1142626"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-1851209-8605861","priority":"111-1851209-8605861"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-6243057-9519402","priority":"111-6243057-9519402"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-5111836-1142626","priority":"111-5111836-1142626"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-6488000-5967432","priority":"111-6488000-5967432"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-1851209-8605861","priority":"111-1851209-8605861"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-3446725-9794664","priority":"113-3446725-9794664"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-6243057-9519402","priority":"111-6243057-9519402"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=112-0686328-4181009","priority":"112-0686328-4181009"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-6488000-5967432","priority":"111-6488000-5967432"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=114-3347246-4437821","priority":"114-3347246-4437821"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=113-2172109-7605841","priority":"113-2172109-7605841"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-2172109-7605841","priority":"113-2172109-7605841"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=113-3446725-9794664","priority":"113-3446725-9794664"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=114-3347246-4437821","priority":"114-3347246-4437821"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=114-6970661-1222608","priority":"114-6970661-1222608"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=114-6970661-1222608","priority":"114-6970661-1222608"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=112-0686328-4181009","priority":"112-0686328-4181009"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-9491172-9672222","priority":"113-9491172-9672222"}]},"running_count":6,"completed_count":2,"error_count":0},"payments_promise":{}},{"id":"111-5111836-1142626","date":"February 15, 2017","total":"$71.27","who":"Mike Sinn","detail_promise":{},
            "items":{"Silicon Power 240GB SSD 3D NAND With Read Up To 550MB/s S55 TLC 7mm (0.28\") Internal Solid State Drive (SP240GBSS3S55S25AE)":"/gp/product/B01M61OWRI/ref=oh_aui_detailpage_o04_s00?ie=UTF8&psc=1"},"request_scheduler":{"CONCURRENCY":6,"queue":{"content":[{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-0418470-3167402","priority":"111-0418470-3167402"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-5111836-1142626","priority":"111-5111836-1142626"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-1851209-8605861","priority":"111-1851209-8605861"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-6243057-9519402","priority":"111-6243057-9519402"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-5111836-1142626","priority":"111-5111836-1142626"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-6488000-5967432","priority":"111-6488000-5967432"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-1851209-8605861","priority":"111-1851209-8605861"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-3446725-9794664","priority":"113-3446725-9794664"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-6243057-9519402","priority":"111-6243057-9519402"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=112-0686328-4181009","priority":"112-0686328-4181009"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-6488000-5967432","priority":"111-6488000-5967432"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=114-3347246-4437821","priority":"114-3347246-4437821"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=113-2172109-7605841","priority":"113-2172109-7605841"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-2172109-7605841","priority":"113-2172109-7605841"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=113-3446725-9794664","priority":"113-3446725-9794664"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=114-3347246-4437821","priority":"114-3347246-4437821"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=114-6970661-1222608","priority":"114-6970661-1222608"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=114-6970661-1222608","priority":"114-6970661-1222608"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=112-0686328-4181009","priority":"112-0686328-4181009"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-9491172-9672222","priority":"113-9491172-9672222"}]},"running_count":6,"completed_count":2,"error_count":0},"payments_promise":{}},{"id":"113-2172109-7605841","date":"January 28, 2017","total":"$3.71","who":"Mike Sinn","detail_promise":{},
            "items":{"Freshburst Listerine Antiseptic Mouthwash Kills Germs Causing Bad Breath, 500 ml":"/gp/product/B000052YCZ/ref=oh_aui_detailpage_o05_s00?ie=UTF8&psc=1"},"request_scheduler":{"CONCURRENCY":6,"queue":{"content":[{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-0418470-3167402","priority":"111-0418470-3167402"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-5111836-1142626","priority":"111-5111836-1142626"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-1851209-8605861","priority":"111-1851209-8605861"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-6243057-9519402","priority":"111-6243057-9519402"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-5111836-1142626","priority":"111-5111836-1142626"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-6488000-5967432","priority":"111-6488000-5967432"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-1851209-8605861","priority":"111-1851209-8605861"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-3446725-9794664","priority":"113-3446725-9794664"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-6243057-9519402","priority":"111-6243057-9519402"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=112-0686328-4181009","priority":"112-0686328-4181009"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-6488000-5967432","priority":"111-6488000-5967432"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=114-3347246-4437821","priority":"114-3347246-4437821"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=113-2172109-7605841","priority":"113-2172109-7605841"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-2172109-7605841","priority":"113-2172109-7605841"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=113-3446725-9794664","priority":"113-3446725-9794664"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=114-3347246-4437821","priority":"114-3347246-4437821"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=114-6970661-1222608","priority":"114-6970661-1222608"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=114-6970661-1222608","priority":"114-6970661-1222608"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=112-0686328-4181009","priority":"112-0686328-4181009"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-9491172-9672222","priority":"113-9491172-9672222"}]},"running_count":6,"completed_count":2,"error_count":0},"payments_promise":{}},{"id":"111-6243057-9519402","date":"January 27, 2017","total":"$71.18","who":"Mike Sinn","detail_promise":{},
            "items":{"LG 32MP58HQ-P 32-Inch IPS Monitor with Screen Split":"/gp/product/B01BV1X9DG/ref=oh_aui_detailpage_o06_s00?ie=UTF8&psc=1"},"request_scheduler":{"CONCURRENCY":6,"queue":{"content":[{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-0418470-3167402","priority":"111-0418470-3167402"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-5111836-1142626","priority":"111-5111836-1142626"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-1851209-8605861","priority":"111-1851209-8605861"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-6243057-9519402","priority":"111-6243057-9519402"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-5111836-1142626","priority":"111-5111836-1142626"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-6488000-5967432","priority":"111-6488000-5967432"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-1851209-8605861","priority":"111-1851209-8605861"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-3446725-9794664","priority":"113-3446725-9794664"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-6243057-9519402","priority":"111-6243057-9519402"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=112-0686328-4181009","priority":"112-0686328-4181009"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-6488000-5967432","priority":"111-6488000-5967432"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=114-3347246-4437821","priority":"114-3347246-4437821"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=113-2172109-7605841","priority":"113-2172109-7605841"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-2172109-7605841","priority":"113-2172109-7605841"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=113-3446725-9794664","priority":"113-3446725-9794664"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=114-3347246-4437821","priority":"114-3347246-4437821"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=114-6970661-1222608","priority":"114-6970661-1222608"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=114-6970661-1222608","priority":"114-6970661-1222608"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=112-0686328-4181009","priority":"112-0686328-4181009"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-9491172-9672222","priority":"113-9491172-9672222"}]},"running_count":6,"completed_count":2,"error_count":0},"payments_promise":{}},{"id":"111-0418470-3167402","date":"January 26, 2017","total":"$1.00","who":"Mike Sinn","detail_promise":{},
            "items":{"Sonic Electric Toothbrush Deep Clean as Dentist Sonicare Rechargeable Waterproof Toothbrush 5 Modes 2 Replacement Heads Tongue Brush by YASI (Black)":"/gp/product/B074Z5D42T/ref=oh_aui_detailpage_o07_s00?ie=UTF8&psc=1"},"request_scheduler":{"CONCURRENCY":6,"queue":{"content":[{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-0418470-3167402","priority":"111-0418470-3167402"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-5111836-1142626","priority":"111-5111836-1142626"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-1851209-8605861","priority":"111-1851209-8605861"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-6243057-9519402","priority":"111-6243057-9519402"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-5111836-1142626","priority":"111-5111836-1142626"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-6488000-5967432","priority":"111-6488000-5967432"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-1851209-8605861","priority":"111-1851209-8605861"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-3446725-9794664","priority":"113-3446725-9794664"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-6243057-9519402","priority":"111-6243057-9519402"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=112-0686328-4181009","priority":"112-0686328-4181009"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-6488000-5967432","priority":"111-6488000-5967432"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=114-3347246-4437821","priority":"114-3347246-4437821"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=113-2172109-7605841","priority":"113-2172109-7605841"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-2172109-7605841","priority":"113-2172109-7605841"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=113-3446725-9794664","priority":"113-3446725-9794664"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=114-3347246-4437821","priority":"114-3347246-4437821"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=114-6970661-1222608","priority":"114-6970661-1222608"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=114-6970661-1222608","priority":"114-6970661-1222608"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=112-0686328-4181009","priority":"112-0686328-4181009"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-9491172-9672222","priority":"113-9491172-9672222"}]},"running_count":6,"completed_count":2,"error_count":0},"payments_promise":{}},{"id":"111-6488000-5967432","date":"January 26, 2017","total":"$1.00","who":"Mike Sinn","detail_promise":{},
            "items":{"Scientific Explorer Infinity Voice Encryptor":"/gp/product/B00D831C58/ref=oh_aui_detailpage_o08_s00?ie=UTF8&psc=1","Spy Guy Secret Mission Set":"/gp/product/B015X278T0/ref=oh_aui_detailpage_o08_s01?ie=UTF8&psc=1"},"request_scheduler":{"CONCURRENCY":6,"queue":{"content":[{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-0418470-3167402","priority":"111-0418470-3167402"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-5111836-1142626","priority":"111-5111836-1142626"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-1851209-8605861","priority":"111-1851209-8605861"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-6243057-9519402","priority":"111-6243057-9519402"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-5111836-1142626","priority":"111-5111836-1142626"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-6488000-5967432","priority":"111-6488000-5967432"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-1851209-8605861","priority":"111-1851209-8605861"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-3446725-9794664","priority":"113-3446725-9794664"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-6243057-9519402","priority":"111-6243057-9519402"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=112-0686328-4181009","priority":"112-0686328-4181009"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-6488000-5967432","priority":"111-6488000-5967432"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=114-3347246-4437821","priority":"114-3347246-4437821"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=113-2172109-7605841","priority":"113-2172109-7605841"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-2172109-7605841","priority":"113-2172109-7605841"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=113-3446725-9794664","priority":"113-3446725-9794664"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=114-3347246-4437821","priority":"114-3347246-4437821"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=114-6970661-1222608","priority":"114-6970661-1222608"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=114-6970661-1222608","priority":"114-6970661-1222608"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=112-0686328-4181009","priority":"112-0686328-4181009"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-9491172-9672222","priority":"113-9491172-9672222"}]},"running_count":6,"completed_count":2,"error_count":0},"payments_promise":{}},{"id":"111-1851209-8605861","date":"January 21, 2017","total":"$1.00","who":"Mike Sinn","detail_promise":{},
            "items":{"Glycerin Vegetable Kosher USP-Highest Quality Available-1 Quart (32 Fluid Ounces)-From Element Six":"/gp/product/B00H4BZM9M/ref=oh_aui_detailpage_o09_s00?ie=UTF8&psc=1"},"request_scheduler":{"CONCURRENCY":6,"queue":{"content":[{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-0418470-3167402","priority":"111-0418470-3167402"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-5111836-1142626","priority":"111-5111836-1142626"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-1851209-8605861","priority":"111-1851209-8605861"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-6243057-9519402","priority":"111-6243057-9519402"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-5111836-1142626","priority":"111-5111836-1142626"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-6488000-5967432","priority":"111-6488000-5967432"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-1851209-8605861","priority":"111-1851209-8605861"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-3446725-9794664","priority":"113-3446725-9794664"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-6243057-9519402","priority":"111-6243057-9519402"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=112-0686328-4181009","priority":"112-0686328-4181009"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-6488000-5967432","priority":"111-6488000-5967432"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=114-3347246-4437821","priority":"114-3347246-4437821"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=113-2172109-7605841","priority":"113-2172109-7605841"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-2172109-7605841","priority":"113-2172109-7605841"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=113-3446725-9794664","priority":"113-3446725-9794664"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=114-3347246-4437821","priority":"114-3347246-4437821"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=114-6970661-1222608","priority":"114-6970661-1222608"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=114-6970661-1222608","priority":"114-6970661-1222608"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=112-0686328-4181009","priority":"112-0686328-4181009"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-9491172-9672222","priority":"113-9491172-9672222"}]},"running_count":6,"completed_count":2,"error_count":0},"payments_promise":{}},{"id":"113-3446725-9794664","date":"January 20, 2017","total":"$1.00","who":"Mike Sinn","detail_promise":{},
            "items":{"DenTek Extra Strong Triple Clean Floss Picks, Mouthwash Blast 90 ea (Pack of 6)":"/gp/product/B002WTCK0U/ref=oh_aui_detailpage_o00_s00?ie=UTF8&psc=1"},"request_scheduler":{"CONCURRENCY":6,"queue":{"content":[{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-0418470-3167402","priority":"111-0418470-3167402"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-5111836-1142626","priority":"111-5111836-1142626"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-1851209-8605861","priority":"111-1851209-8605861"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-6243057-9519402","priority":"111-6243057-9519402"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-5111836-1142626","priority":"111-5111836-1142626"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-6488000-5967432","priority":"111-6488000-5967432"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-1851209-8605861","priority":"111-1851209-8605861"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-3446725-9794664","priority":"113-3446725-9794664"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-6243057-9519402","priority":"111-6243057-9519402"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=112-0686328-4181009","priority":"112-0686328-4181009"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-6488000-5967432","priority":"111-6488000-5967432"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=114-3347246-4437821","priority":"114-3347246-4437821"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=113-2172109-7605841","priority":"113-2172109-7605841"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-2172109-7605841","priority":"113-2172109-7605841"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=113-3446725-9794664","priority":"113-3446725-9794664"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=114-3347246-4437821","priority":"114-3347246-4437821"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=114-6970661-1222608","priority":"114-6970661-1222608"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=114-6970661-1222608","priority":"114-6970661-1222608"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=112-0686328-4181009","priority":"112-0686328-4181009"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-9491172-9672222","priority":"113-9491172-9672222"}]},"running_count":6,"completed_count":2,"error_count":0},"payments_promise":{}},{"id":"114-6970661-1222608","date":"January 17, 2017","total":"$1.00","who":"Mike Sinn","detail_promise":{},
            "items":{"Maldon Sea Salt Flakes, 8.5 ounce Box":"/gp/product/B00017028M/ref=oh_aui_detailpage_o01_s00?ie=UTF8&psc=1"},"request_scheduler":{"CONCURRENCY":6,"queue":{"content":[{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-0418470-3167402","priority":"111-0418470-3167402"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-5111836-1142626","priority":"111-5111836-1142626"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-1851209-8605861","priority":"111-1851209-8605861"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-6243057-9519402","priority":"111-6243057-9519402"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-5111836-1142626","priority":"111-5111836-1142626"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-6488000-5967432","priority":"111-6488000-5967432"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-1851209-8605861","priority":"111-1851209-8605861"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-3446725-9794664","priority":"113-3446725-9794664"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=111-6243057-9519402","priority":"111-6243057-9519402"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=112-0686328-4181009","priority":"112-0686328-4181009"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=111-6488000-5967432","priority":"111-6488000-5967432"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=114-3347246-4437821","priority":"114-3347246-4437821"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=113-2172109-7605841","priority":"113-2172109-7605841"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-2172109-7605841","priority":"113-2172109-7605841"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=113-3446725-9794664","priority":"113-3446725-9794664"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=114-3347246-4437821","priority":"114-3347246-4437821"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=114-6970661-1222608","priority":"114-6970661-1222608"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=114-6970661-1222608","priority":"114-6970661-1222608"},{"query":"https://www.amazon.com/gp/your-account/order-details/ref=oh_aui_or_o01_?ie=UTF8&orderID=112-0686328-4181009","priority":"112-0686328-4181009"},{"query":"https://www.amazon.com/gp/css/summary/print.html/ref=oh_aui_ajax_pi?ie=UTF8&orderID=113-9491172-9672222","priority":"113-9491172-9672222"}]},"running_count":6,"completed_count":2,"error_count":0},"payments_promise":{}}]
        ';
    }
    public function testPostNewVariableMeasurements(){
        TestDB::deleteUserData();
        $this->setAuthenticatedUser(1);
        $responseData = $this->postAndCheckMeasurementsResponse([
            "variableName" => "1521412625 Unique Test Variable",
            "value" => 3,
            "startTimeEpoch" => 1521413742,
            "unitAbbreviatedName" => "/5",
            "variableCategoryName" => "Emotions",
            "latitude" => null,
            "sourceName" => "QuantiModo for web"
        ]);
        $commonVariable = QMCommonVariable::findByNameIdOrSynonym("1521412625 Unique Test Variable");
        $this->assertNotNull($commonVariable);
        $userVariable = QMUserVariable::findUserVariableByNameIdOrSynonym(1, "1521412625 Unique Test Variable");
        $this->assertNotNull($userVariable);
        /** @var QMUserVariable[] $userVariables */
        $userVariables = $responseData->userVariables;
        $this->assertVariablesContain("1521412625 Unique Test Variable", $userVariables);
        $this->assertEquals(OneToFiveRatingUnit::ABBREVIATED_NAME, $userVariable->getUserUnit()->abbreviatedName);
    }
	/**
	 * @param string|null $variableName
	 */
	protected function assertDoesNotHaveTrackingReminderFor(string $variableName){
		$reminders = $this->getOrSetAuthenticatedUser(1)->getTrackingRemindersByVariableName($variableName);
		$this->assertCountAndPrintIfFalse(0, $reminders);
	}
}
